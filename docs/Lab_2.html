<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Г. Мороз" />


<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Lab_1.html">Lab 1</a>
</li>
<li>
  <a href="Lab_2.html">Lab 2</a>
</li>
<li>
  <a href="Lab_3.html">Lab 3</a>
</li>
<li>
  <a href="Lab_4.html">Lab 4</a>
</li>
<li>
  <a href="Lab_5.html">Lab 5</a>
</li>
<li>
  <a href="Lab_6.html">Lab 6</a>
</li>
<li>
  <a href="Lab_7.html">Lab 7</a>
</li>
<li>
  <a href="Lab_8.html">Lab 8</a>
</li>
<li>
  <a href="Lab_9.html">Lab 9</a>
</li>
<li>
  <a href="Lab_10.html">Lab 10</a>
</li>
<li>
  <a href="Lab_11.html">Lab 11</a>
</li>
<li>
  <a href="Lab_12.html">Lab 12</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore"><ol start="2" style="list-style-type: decimal">
<li>tidyverse</li>
</ol></h1>
<h4 class="author"><em>Г. Мороз</em></h4>

</div>


<style>
.parallax {
    /* The image used */
    background-image: url("2_tidyverse.png");
    
    /* Set a specific height */
    min-height: 300px; 

    /* Create the parallax scrolling effect */
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: auto;
}
.parallax2 {
    /* The image used */
    background-image: url("2_magrittr.png");
    
    /* Set a specific height */
    min-height: 300px; 

    /* Create the parallax scrolling effect */
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: auto;
}
</style>
<div class="parallax">

</div>
<div class="section level3">
<h3>1. Введение</h3>
<p><a href="https://www.tidyverse.org"><em>tidyverse</em></a> — это набор пакетов:</p>
<ul>
<li><em>dplyr</em>, для преобразованиия данных</li>
<li><em>ggplot2</em>, для визуализации</li>
<li><em>tidyr</em>, для формата tidy data</li>
<li><em>readr</em>, для чтения файлов в R</li>
<li><em>purrr</em>, для функционального программирования</li>
<li><em>tibble</em>, для работы с тибблами, современный вариант датафрейма</li>
</ul>
<p>Полезно также знать:</p>
<ul>
<li><em>readxl</em>, для чтения .xls и .xlsx</li>
<li><em>jsonlite</em>, для работы с JSON</li>
<li><em>rvest</em>, для веб-скреппинга</li>
<li><em>lubridate</em>, для работы с временем</li>
<li><em>tidytext</em>, для работы с текстами и корпусами</li>
<li><em>broom</em>, для перевода в tidy формат статистические модели</li>
</ul>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 2.2.1     ✔ purrr   0.2.4
## ✔ tibble  1.4.2     ✔ dplyr   0.7.4
## ✔ tidyr   0.7.2     ✔ stringr 1.2.0
## ✔ readr   1.1.1     ✔ forcats 0.2.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="parallax">

</div>
</div>
<div id="tible" class="section level3">
<h3>2. tible</h3>
<pre class="r"><code>head(iris)
as_tibble(iris)
data_frame(id = 1:12,
           letters = month.name)</code></pre>
<div class="parallax">

</div>
</div>
<div id="--readr-readxl" class="section level3">
<h3>3. Чтение файлов: readr, readxl</h3>
<pre class="r"><code>library(readr)
df &lt;- read_csv(&quot;https://goo.gl/v7nvho&quot;)
head(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Gender"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Age"],"name":[2],"type":["int"],"align":["right"]},{"label":["AgeGroup"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Education"],"name":[4],"type":["chr"],"align":["left"]},{"label":["City"],"name":[5],"type":["chr"],"align":["left"]},{"label":["SubjectCode"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Score"],"name":[7],"type":["chr"],"align":["left"]},{"label":["GivenScore"],"name":[8],"type":["int"],"align":["right"]},{"label":["Stimulus"],"name":[9],"type":["chr"],"align":["left"]},{"label":["Prefix"],"name":[10],"type":["chr"],"align":["left"]},{"label":["WordType"],"name":[11],"type":["chr"],"align":["left"]},{"label":["CorpusFrequency"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"utochnit","10":"u","11":"standard","12":"2860"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"ozhestochit","10":"o","11":"standard","12":"686"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"E","8":"1","9":"ovneshnit","10":"o","11":"marginal","12":"4"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"E","8":"1","9":"oblusit","10":"o","11":"nonce","12":"0"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"osvezhit","10":"o","11":"standard","12":"280"},{"1":"female","2":"16","3":"child","4":"school","5":"Izhevsk","6":"AA","7":"A","8":"5","9":"oschastlivit","10":"o","11":"standard","12":"343"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>df &lt;- read_tsv(&quot;https://goo.gl/33r2Ut&quot;)
head(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["gender"],"name":[3],"type":["chr"],"align":["left"]},{"label":["cons"],"name":[4],"type":["int"],"align":["right"]},{"label":["inn"],"name":[5],"type":["int"],"align":["right"]},{"label":["total"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"ait1954","2":"1954","3":"f","4":"222","5":"254","6":"476"},{"1":"anp1929","2":"1929","3":"m","4":"15","5":"16","6":"31"},{"1":"ans1925","2":"1925","3":"f","4":"788","5":"379","6":"1167"},{"1":"avch1930","2":"1930","3":"f","4":"43","5":"6","6":"49"},{"1":"avi1958","2":"1958","3":"f","4":"1","5":"31","6":"32"},{"1":"avm1922","2":"1922","3":"f","4":"778","5":"235","6":"1013"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>df &lt;- read_delim(&quot;https://goo.gl/33r2Ut&quot;, delim = &quot;\t&quot;)
head(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["gender"],"name":[3],"type":["chr"],"align":["left"]},{"label":["cons"],"name":[4],"type":["int"],"align":["right"]},{"label":["inn"],"name":[5],"type":["int"],"align":["right"]},{"label":["total"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"ait1954","2":"1954","3":"f","4":"222","5":"254","6":"476"},{"1":"anp1929","2":"1929","3":"m","4":"15","5":"16","6":"31"},{"1":"ans1925","2":"1925","3":"f","4":"788","5":"379","6":"1167"},{"1":"avch1930","2":"1930","3":"f","4":"43","5":"6","6":"49"},{"1":"avi1958","2":"1958","3":"f","4":"1","5":"31","6":"32"},{"1":"avm1922","2":"1922","3":"f","4":"778","5":"235","6":"1013"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>library(readxl)
xlsx_example &lt;- readxl_example(&quot;datasets.xlsx&quot;)
df &lt;- read_excel(xlsx_example)
head(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Petal.Length"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Species"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"5.1","2":"3.5","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.9","2":"3.0","3":"1.4","4":"0.2","5":"setosa"},{"1":"4.7","2":"3.2","3":"1.3","4":"0.2","5":"setosa"},{"1":"4.6","2":"3.1","3":"1.5","4":"0.2","5":"setosa"},{"1":"5.0","2":"3.6","3":"1.4","4":"0.2","5":"setosa"},{"1":"5.4","2":"3.9","3":"1.7","4":"0.4","5":"setosa"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>excel_sheets(xlsx_example)</code></pre>
<pre><code>## [1] &quot;iris&quot;     &quot;mtcars&quot;   &quot;chickwts&quot; &quot;quakes&quot;</code></pre>
<pre class="r"><code>df &lt;- read_excel(xlsx_example, sheet = &quot;mtcars&quot;)
head(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["am"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["carb"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"21.0","2":"6","3":"160","4":"110","5":"3.90","6":"2.620","7":"16.46","8":"0","9":"1","10":"4","11":"4"},{"1":"21.0","2":"6","3":"160","4":"110","5":"3.90","6":"2.875","7":"17.02","8":"0","9":"1","10":"4","11":"4"},{"1":"22.8","2":"4","3":"108","4":"93","5":"3.85","6":"2.320","7":"18.61","8":"1","9":"1","10":"4","11":"1"},{"1":"21.4","2":"6","3":"258","4":"110","5":"3.08","6":"3.215","7":"19.44","8":"1","9":"0","10":"3","11":"1"},{"1":"18.7","2":"8","3":"360","4":"175","5":"3.15","6":"3.440","7":"17.02","8":"0","9":"0","10":"3","11":"2"},{"1":"18.1","2":"6","3":"225","4":"105","5":"2.76","6":"3.460","7":"20.22","8":"1","9":"0","10":"3","11":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>rm(df)</code></pre>
<div class="parallax">

</div>
</div>
<div id="dplyr" class="section level3">
<h3>4. <code>dplyr</code></h3>
<pre class="r"><code>homo &lt;- read_csv(&quot;http://goo.gl/Zjr9aF&quot;)
homo</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[6],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[7],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[9],"type":["chr"],"align":["left"]},{"label":["age"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"A","2":"61.40","3":"112.60","4":"119.51","5":"52.5","6":"7","7":"18","8":"0.28","9":"hetero","10":"30"},{"1":"B","2":"63.90","3":"126.49","4":"100.29","5":"114.0","6":"20","7":"5","8":"0.80","9":"hetero","10":"19"},{"1":"C","2":"55.08","3":"126.81","4":"114.90","5":"103.2","6":"9","7":"16","8":"0.36","9":"homo","10":"29"},{"1":"D","2":"78.11","3":"119.17","4":"126.61","5":"58.8","6":"15","7":"10","8":"0.60","9":"homo","10":"36"},{"1":"E","2":"64.71","3":"93.68","4":"130.76","5":"37.4","6":"10","7":"15","8":"0.40","9":"homo","10":"27"},{"1":"F","2":"67.00","3":"127.87","4":"150.79","5":"42.0","6":"17","7":"8","8":"0.68","9":"homo","10":"33"},{"1":"G","2":"65.39","3":"147.52","4":"128.96","5":"118.2","6":"20","7":"5","8":"0.80","9":"hetero","10":"28"},{"1":"H","2":"62.46","3":"120.13","4":"105.26","5":"55.7","6":"21","7":"4","8":"0.84","9":"hetero","10":"22"},{"1":"I","2":"60.45","3":"140.44","4":"109.86","5":"96.4","6":"20","7":"5","8":"0.80","9":"homo","10":"22"},{"1":"J","2":"59.59","3":"121.01","4":"123.90","5":"111.7","6":"8","7":"17","8":"0.32","9":"homo","10":"40"},{"1":"K","2":"62.94","3":"137.37","4":"119.48","5":"87.6","6":"21","7":"4","8":"0.84","9":"homo","10":"30"},{"1":"L","2":"53.31","3":"112.05","4":"146.20","5":"57.8","6":"8","7":"17","8":"0.32","9":"hetero","10":"25"},{"1":"M","2":"45.13","3":"133.74","4":"155.34","5":"100.5","6":"9","7":"16","8":"0.36","9":"hetero","10":"20"},{"1":"N","2":"57.67","3":"118.02","4":"121.48","5":"37.4","6":"4","7":"21","8":"0.16","9":"hetero","10":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The majority of examples in that presentation are based on <a href="http://goo.gl/MKfSc6">Hau 2007</a>. Experiment consisted of a perception and judgment test aimed at measuring the correlation between acoustic cues and perceived sexual orientation. Naïve Cantonese speakers were asked to listen to the Cantonese speech samples collected in Experiment and judge whether the speakers were gay or heterosexual. There are 14 speakers and following parameters:</p>
<ul>
<li>[s] duration (<em>s.duration.ms</em>)</li>
<li>vowel duration (<em>vowel.duration.ms</em>)</li>
<li>fundamental frequencies mean (F0) (<em>average.f0.Hz</em>)</li>
<li>fundamental frequencies range (<em>f0.range.Hz</em>)</li>
<li>percentage of homosexual impression (<em>perceived.as.homo</em>)</li>
<li>percentage of heterosexal impression (<em>perceived.as.hetero</em>)</li>
<li>speakers orientation (<em>orientation</em>)</li>
<li>speakers age (<em>age</em>)</li>
</ul>
<div id="dplyrfilter" class="section level4">
<h4>4.1 <code>dplyr::filter()</code></h4>
<p>How many speakers are older than 28?</p>
<pre class="r"><code>homo %&gt;%
  filter(age &gt; 28, s.duration.ms &lt; 60)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[6],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[7],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[9],"type":["chr"],"align":["left"]},{"label":["age"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"C","2":"55.08","3":"126.81","4":"114.90","5":"103.2","6":"9","7":"16","8":"0.36","9":"homo","10":"29"},{"1":"J","2":"59.59","3":"121.01","4":"123.90","5":"111.7","6":"8","7":"17","8":"0.32","9":"homo","10":"40"},{"1":"N","2":"57.67","3":"118.02","4":"121.48","5":"37.4","6":"4","7":"21","8":"0.16","9":"hetero","10":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code>%&gt;%</code> — конвеер (pipe) отправляет результат работы одной функции в другую.</p>
<pre class="r"><code>sort(sqrt(abs(sin(1:22))), decreasing = TRUE)</code></pre>
<pre><code>##  [1] 0.9999951 0.9952926 0.9946649 0.9805088 0.9792468 0.9554817 0.9535709
##  [8] 0.9173173 0.9146888 0.8699440 0.8665952 0.8105471 0.8064043 0.7375779
## [15] 0.7325114 0.6482029 0.6419646 0.5365662 0.5285977 0.3871398 0.3756594
## [22] 0.0940814</code></pre>
<pre class="r"><code>1:22 %&gt;% 
  sin() %&gt;% 
  abs() %&gt;% 
  sqrt() %&gt;% 
  sort(., decreasing = TRUE) # зачем здесь точка?</code></pre>
<pre><code>##  [1] 0.9999951 0.9952926 0.9946649 0.9805088 0.9792468 0.9554817 0.9535709
##  [8] 0.9173173 0.9146888 0.8699440 0.8665952 0.8105471 0.8064043 0.7375779
## [15] 0.7325114 0.6482029 0.6419646 0.5365662 0.5285977 0.3871398 0.3756594
## [22] 0.0940814</code></pre>
<p>Конвееры в <em>tidyverse</em> пришли из пакета <em>magrittr</em>. Иногда они работают не корректно с функциями не из <em>tidyverse</em>.</p>
<div class="parallax2">

</div>
</div>
<div id="dplyrslice" class="section level4">
<h4>4.2 <code>dplyr::slice()</code></h4>
<pre class="r"><code>homo %&gt;%
  slice(3:7)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[6],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[7],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[9],"type":["chr"],"align":["left"]},{"label":["age"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"C","2":"55.08","3":"126.81","4":"114.90","5":"103.2","6":"9","7":"16","8":"0.36","9":"homo","10":"29"},{"1":"D","2":"78.11","3":"119.17","4":"126.61","5":"58.8","6":"15","7":"10","8":"0.60","9":"homo","10":"36"},{"1":"E","2":"64.71","3":"93.68","4":"130.76","5":"37.4","6":"10","7":"15","8":"0.40","9":"homo","10":"27"},{"1":"F","2":"67.00","3":"127.87","4":"150.79","5":"42.0","6":"17","7":"8","8":"0.68","9":"homo","10":"33"},{"1":"G","2":"65.39","3":"147.52","4":"128.96","5":"118.2","6":"20","7":"5","8":"0.80","9":"hetero","10":"28"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
</div>
<div id="dplyrselect" class="section level4">
<h4>4.3 <code>dplyr::select()</code></h4>
<pre class="r"><code>homo %&gt;%
  select(8:10)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["perceived.as.homo.percent"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[2],"type":["chr"],"align":["left"]},{"label":["age"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"0.28","2":"hetero","3":"30"},{"1":"0.80","2":"hetero","3":"19"},{"1":"0.36","2":"homo","3":"29"},{"1":"0.60","2":"homo","3":"36"},{"1":"0.40","2":"homo","3":"27"},{"1":"0.68","2":"homo","3":"33"},{"1":"0.80","2":"hetero","3":"28"},{"1":"0.84","2":"hetero","3":"22"},{"1":"0.80","2":"homo","3":"22"},{"1":"0.32","2":"homo","3":"40"},{"1":"0.84","2":"homo","3":"30"},{"1":"0.32","2":"hetero","3":"25"},{"1":"0.36","2":"hetero","3":"20"},{"1":"0.16","2":"hetero","3":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  select(speaker:average.f0.Hz)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"61.40","3":"112.60","4":"119.51"},{"1":"B","2":"63.90","3":"126.49","4":"100.29"},{"1":"C","2":"55.08","3":"126.81","4":"114.90"},{"1":"D","2":"78.11","3":"119.17","4":"126.61"},{"1":"E","2":"64.71","3":"93.68","4":"130.76"},{"1":"F","2":"67.00","3":"127.87","4":"150.79"},{"1":"G","2":"65.39","3":"147.52","4":"128.96"},{"1":"H","2":"62.46","3":"120.13","4":"105.26"},{"1":"I","2":"60.45","3":"140.44","4":"109.86"},{"1":"J","2":"59.59","3":"121.01","4":"123.90"},{"1":"K","2":"62.94","3":"137.37","4":"119.48"},{"1":"L","2":"53.31","3":"112.05","4":"146.20"},{"1":"M","2":"45.13","3":"133.74","4":"155.34"},{"1":"N","2":"57.67","3":"118.02","4":"121.48"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  select(-speaker)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["s.duration.ms"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[5],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[6],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[8],"type":["chr"],"align":["left"]},{"label":["age"],"name":[9],"type":["int"],"align":["right"]}],"data":[{"1":"61.40","2":"112.60","3":"119.51","4":"52.5","5":"7","6":"18","7":"0.28","8":"hetero","9":"30"},{"1":"63.90","2":"126.49","3":"100.29","4":"114.0","5":"20","6":"5","7":"0.80","8":"hetero","9":"19"},{"1":"55.08","2":"126.81","3":"114.90","4":"103.2","5":"9","6":"16","7":"0.36","8":"homo","9":"29"},{"1":"78.11","2":"119.17","3":"126.61","4":"58.8","5":"15","6":"10","7":"0.60","8":"homo","9":"36"},{"1":"64.71","2":"93.68","3":"130.76","4":"37.4","5":"10","6":"15","7":"0.40","8":"homo","9":"27"},{"1":"67.00","2":"127.87","3":"150.79","4":"42.0","5":"17","6":"8","7":"0.68","8":"homo","9":"33"},{"1":"65.39","2":"147.52","3":"128.96","4":"118.2","5":"20","6":"5","7":"0.80","8":"hetero","9":"28"},{"1":"62.46","2":"120.13","3":"105.26","4":"55.7","5":"21","6":"4","7":"0.84","8":"hetero","9":"22"},{"1":"60.45","2":"140.44","3":"109.86","4":"96.4","5":"20","6":"5","7":"0.80","8":"homo","9":"22"},{"1":"59.59","2":"121.01","3":"123.90","4":"111.7","5":"8","6":"17","7":"0.32","8":"homo","9":"40"},{"1":"62.94","2":"137.37","3":"119.48","4":"87.6","5":"21","6":"4","7":"0.84","8":"homo","9":"30"},{"1":"53.31","2":"112.05","3":"146.20","4":"57.8","5":"8","6":"17","7":"0.32","8":"hetero","9":"25"},{"1":"45.13","2":"133.74","3":"155.34","4":"100.5","5":"9","6":"16","7":"0.36","8":"hetero","9":"20"},{"1":"57.67","2":"118.02","3":"121.48","4":"37.4","5":"4","6":"21","7":"0.16","8":"hetero","9":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  select(-c(speaker, perceived.as.hetero, perceived.as.homo, perceived.as.homo.percent))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["s.duration.ms"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[5],"type":["chr"],"align":["left"]},{"label":["age"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"61.40","2":"112.60","3":"119.51","4":"52.5","5":"hetero","6":"30"},{"1":"63.90","2":"126.49","3":"100.29","4":"114.0","5":"hetero","6":"19"},{"1":"55.08","2":"126.81","3":"114.90","4":"103.2","5":"homo","6":"29"},{"1":"78.11","2":"119.17","3":"126.61","4":"58.8","5":"homo","6":"36"},{"1":"64.71","2":"93.68","3":"130.76","4":"37.4","5":"homo","6":"27"},{"1":"67.00","2":"127.87","3":"150.79","4":"42.0","5":"homo","6":"33"},{"1":"65.39","2":"147.52","3":"128.96","4":"118.2","5":"hetero","6":"28"},{"1":"62.46","2":"120.13","3":"105.26","4":"55.7","5":"hetero","6":"22"},{"1":"60.45","2":"140.44","3":"109.86","4":"96.4","5":"homo","6":"22"},{"1":"59.59","2":"121.01","3":"123.90","4":"111.7","5":"homo","6":"40"},{"1":"62.94","2":"137.37","3":"119.48","4":"87.6","5":"homo","6":"30"},{"1":"53.31","2":"112.05","3":"146.20","4":"57.8","5":"hetero","6":"25"},{"1":"45.13","2":"133.74","3":"155.34","4":"100.5","5":"hetero","6":"20"},{"1":"57.67","2":"118.02","3":"121.48","4":"37.4","5":"hetero","6":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  select(speaker, age, s.duration.ms)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age"],"name":[2],"type":["int"],"align":["right"]},{"label":["s.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"30","3":"61.40"},{"1":"B","2":"19","3":"63.90"},{"1":"C","2":"29","3":"55.08"},{"1":"D","2":"36","3":"78.11"},{"1":"E","2":"27","3":"64.71"},{"1":"F","2":"33","3":"67.00"},{"1":"G","2":"28","3":"65.39"},{"1":"H","2":"22","3":"62.46"},{"1":"I","2":"22","3":"60.45"},{"1":"J","2":"40","3":"59.59"},{"1":"K","2":"30","3":"62.94"},{"1":"L","2":"25","3":"53.31"},{"1":"M","2":"20","3":"45.13"},{"1":"N","2":"29","3":"57.67"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
</div>
<div id="dplyrarrange" class="section level4">
<h4>4.4 <code>dplyr::arrange()</code></h4>
<pre class="r"><code>homo %&gt;%
  arrange(orientation, desc(age))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[6],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[7],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[9],"type":["chr"],"align":["left"]},{"label":["age"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"A","2":"61.40","3":"112.60","4":"119.51","5":"52.5","6":"7","7":"18","8":"0.28","9":"hetero","10":"30"},{"1":"N","2":"57.67","3":"118.02","4":"121.48","5":"37.4","6":"4","7":"21","8":"0.16","9":"hetero","10":"29"},{"1":"G","2":"65.39","3":"147.52","4":"128.96","5":"118.2","6":"20","7":"5","8":"0.80","9":"hetero","10":"28"},{"1":"L","2":"53.31","3":"112.05","4":"146.20","5":"57.8","6":"8","7":"17","8":"0.32","9":"hetero","10":"25"},{"1":"H","2":"62.46","3":"120.13","4":"105.26","5":"55.7","6":"21","7":"4","8":"0.84","9":"hetero","10":"22"},{"1":"M","2":"45.13","3":"133.74","4":"155.34","5":"100.5","6":"9","7":"16","8":"0.36","9":"hetero","10":"20"},{"1":"B","2":"63.90","3":"126.49","4":"100.29","5":"114.0","6":"20","7":"5","8":"0.80","9":"hetero","10":"19"},{"1":"J","2":"59.59","3":"121.01","4":"123.90","5":"111.7","6":"8","7":"17","8":"0.32","9":"homo","10":"40"},{"1":"D","2":"78.11","3":"119.17","4":"126.61","5":"58.8","6":"15","7":"10","8":"0.60","9":"homo","10":"36"},{"1":"F","2":"67.00","3":"127.87","4":"150.79","5":"42.0","6":"17","7":"8","8":"0.68","9":"homo","10":"33"},{"1":"K","2":"62.94","3":"137.37","4":"119.48","5":"87.6","6":"21","7":"4","8":"0.84","9":"homo","10":"30"},{"1":"C","2":"55.08","3":"126.81","4":"114.90","5":"103.2","6":"9","7":"16","8":"0.36","9":"homo","10":"29"},{"1":"E","2":"64.71","3":"93.68","4":"130.76","5":"37.4","6":"10","7":"15","8":"0.40","9":"homo","10":"27"},{"1":"I","2":"60.45","3":"140.44","4":"109.86","5":"96.4","6":"20","7":"5","8":"0.80","9":"homo","10":"22"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
</div>
<div id="dplyrdistinct" class="section level4">
<h4>4.5 <code>dplyr::distinct()</code></h4>
<pre class="r"><code>homo %&gt;%
  distinct(orientation)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"hetero"},{"1":"homo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  distinct(orientation, age &gt; 20)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age > 20"],"name":[2],"type":["lgl"],"align":["right"]}],"data":[{"1":"hetero","2":"TRUE"},{"1":"hetero","2":"FALSE"},{"1":"homo","2":"TRUE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
</div>
<div id="dplyrmutate" class="section level4">
<h4>4.6 <code>dplyr::mutate()</code></h4>
<pre class="r"><code>homo %&gt;%
  mutate(f0.mn = average.f0.Hz - f0.range.Hz/2,
         f0.mx = (average.f0.Hz + f0.range.Hz/2))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["speaker"],"name":[1],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[6],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[7],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["orientation"],"name":[9],"type":["chr"],"align":["left"]},{"label":["age"],"name":[10],"type":["int"],"align":["right"]},{"label":["f0.mn"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["f0.mx"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"61.40","3":"112.60","4":"119.51","5":"52.5","6":"7","7":"18","8":"0.28","9":"hetero","10":"30","11":"93.26","12":"145.76"},{"1":"B","2":"63.90","3":"126.49","4":"100.29","5":"114.0","6":"20","7":"5","8":"0.80","9":"hetero","10":"19","11":"43.29","12":"157.29"},{"1":"C","2":"55.08","3":"126.81","4":"114.90","5":"103.2","6":"9","7":"16","8":"0.36","9":"homo","10":"29","11":"63.30","12":"166.50"},{"1":"D","2":"78.11","3":"119.17","4":"126.61","5":"58.8","6":"15","7":"10","8":"0.60","9":"homo","10":"36","11":"97.21","12":"156.01"},{"1":"E","2":"64.71","3":"93.68","4":"130.76","5":"37.4","6":"10","7":"15","8":"0.40","9":"homo","10":"27","11":"112.06","12":"149.46"},{"1":"F","2":"67.00","3":"127.87","4":"150.79","5":"42.0","6":"17","7":"8","8":"0.68","9":"homo","10":"33","11":"129.79","12":"171.79"},{"1":"G","2":"65.39","3":"147.52","4":"128.96","5":"118.2","6":"20","7":"5","8":"0.80","9":"hetero","10":"28","11":"69.86","12":"188.06"},{"1":"H","2":"62.46","3":"120.13","4":"105.26","5":"55.7","6":"21","7":"4","8":"0.84","9":"hetero","10":"22","11":"77.41","12":"133.11"},{"1":"I","2":"60.45","3":"140.44","4":"109.86","5":"96.4","6":"20","7":"5","8":"0.80","9":"homo","10":"22","11":"61.66","12":"158.06"},{"1":"J","2":"59.59","3":"121.01","4":"123.90","5":"111.7","6":"8","7":"17","8":"0.32","9":"homo","10":"40","11":"68.05","12":"179.75"},{"1":"K","2":"62.94","3":"137.37","4":"119.48","5":"87.6","6":"21","7":"4","8":"0.84","9":"homo","10":"30","11":"75.68","12":"163.28"},{"1":"L","2":"53.31","3":"112.05","4":"146.20","5":"57.8","6":"8","7":"17","8":"0.32","9":"hetero","10":"25","11":"117.30","12":"175.10"},{"1":"M","2":"45.13","3":"133.74","4":"155.34","5":"100.5","6":"9","7":"16","8":"0.36","9":"hetero","10":"20","11":"105.09","12":"205.59"},{"1":"N","2":"57.67","3":"118.02","4":"121.48","5":"37.4","6":"4","7":"21","8":"0.16","9":"hetero","10":"29","11":"102.78","12":"140.18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
</div>
<div id="dplyrgroup_by...-summarise..." class="section level4">
<h4>4.7 <code>dplyr::group_by(...) %&gt;% summarise(...)</code></h4>
<pre class="r"><code>homo %&gt;%
  summarise(min(age), mean(s.duration.ms))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["min(age)"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mean(s.duration.ms)"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"19","2":"61.22429"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  group_by(orientation) %&gt;% 
  summarise(my_mean = mean(s.duration.ms))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["my_mean"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"hetero","2":"58.46571"},{"1":"homo","2":"63.98286"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  group_by(orientation) %&gt;% 
  summarise(mean(s.duration.ms))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean(s.duration.ms)"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"hetero","2":"58.46571"},{"1":"homo","2":"63.98286"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;%
  group_by(orientation) %&gt;% 
  summarise(mean_by_orientation = mean(s.duration.ms))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean_by_orientation"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"hetero","2":"58.46571"},{"1":"homo","2":"63.98286"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Если нужно посчитать количество вхождений, то можно использовать функцию <code>n()</code> в <code>summarise()</code> или же функцию <code>count()</code>:</p>
<pre class="r"><code>homo %&gt;% 
  group_by(orientation, age &gt; 20) %&gt;% 
  summarise(my_mean = mean(s.duration.ms), n_observations = n())</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age > 20"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["my_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n_observations"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"hetero","2":"FALSE","3":"54.51500","4":"2"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;% 
  count(orientation, age &gt; 20)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age > 20"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"hetero","2":"FALSE","3":"2"},{"1":"hetero","2":"TRUE","3":"5"},{"1":"homo","2":"TRUE","3":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
</div>
<div id="dplyr.._join" class="section level4">
<h4>4.8 <code>dplyr::.._join()</code></h4>
<pre class="r"><code>languages &lt;- data_frame(
  languages = c(&quot;Selkup&quot;, &quot;French&quot;, &quot;Chukchi&quot;, &quot;Kashubian&quot;),
  countries = c(&quot;Russia&quot;, &quot;France&quot;, &quot;Russia&quot;, &quot;Poland&quot;),
  iso = c(&quot;sel&quot;, &quot;fra&quot;, &quot;ckt&quot;, &quot;pol&quot;)
  )
languages</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["languages"],"name":[1],"type":["chr"],"align":["left"]},{"label":["countries"],"name":[2],"type":["chr"],"align":["left"]},{"label":["iso"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Selkup","2":"Russia","3":"sel"},{"1":"French","2":"France","3":"fra"},{"1":"Chukchi","2":"Russia","3":"ckt"},{"1":"Kashubian","2":"Poland","3":"pol"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>country_population &lt;- data_frame(
  countries = c(&quot;Russia&quot;, &quot;Poland&quot;, &quot;Finland&quot;),
  population_mln = c(143, 38, 5))
country_population</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["countries"],"name":[1],"type":["chr"],"align":["left"]},{"label":["population_mln"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Russia","2":"143"},{"1":"Poland","2":"38"},{"1":"Finland","2":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>inner_join(languages, country_population)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["languages"],"name":[1],"type":["chr"],"align":["left"]},{"label":["countries"],"name":[2],"type":["chr"],"align":["left"]},{"label":["iso"],"name":[3],"type":["chr"],"align":["left"]},{"label":["population_mln"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Selkup","2":"Russia","3":"sel","4":"143"},{"1":"Chukchi","2":"Russia","3":"ckt","4":"143"},{"1":"Kashubian","2":"Poland","3":"pol","4":"38"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>left_join(languages, country_population)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["languages"],"name":[1],"type":["chr"],"align":["left"]},{"label":["countries"],"name":[2],"type":["chr"],"align":["left"]},{"label":["iso"],"name":[3],"type":["chr"],"align":["left"]},{"label":["population_mln"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Selkup","2":"Russia","3":"sel","4":"143"},{"1":"French","2":"France","3":"fra","4":"NA"},{"1":"Chukchi","2":"Russia","3":"ckt","4":"143"},{"1":"Kashubian","2":"Poland","3":"pol","4":"38"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>right_join(languages, country_population)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["languages"],"name":[1],"type":["chr"],"align":["left"]},{"label":["countries"],"name":[2],"type":["chr"],"align":["left"]},{"label":["iso"],"name":[3],"type":["chr"],"align":["left"]},{"label":["population_mln"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Selkup","2":"Russia","3":"sel","4":"143"},{"1":"Chukchi","2":"Russia","3":"ckt","4":"143"},{"1":"Kashubian","2":"Poland","3":"pol","4":"38"},{"1":"NA","2":"Finland","3":"NA","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>anti_join(languages, country_population)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["languages"],"name":[1],"type":["chr"],"align":["left"]},{"label":["countries"],"name":[2],"type":["chr"],"align":["left"]},{"label":["iso"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"French","2":"France","3":"fra"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>anti_join(country_population, languages)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["countries"],"name":[1],"type":["chr"],"align":["left"]},{"label":["population_mln"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Finland","2":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>full_join(country_population, languages)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["countries"],"name":[1],"type":["chr"],"align":["left"]},{"label":["population_mln"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["languages"],"name":[3],"type":["chr"],"align":["left"]},{"label":["iso"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Russia","2":"143","3":"Selkup","4":"sel"},{"1":"Russia","2":"143","3":"Chukchi","4":"ckt"},{"1":"Poland","2":"38","3":"Kashubian","4":"pol"},{"1":"Finland","2":"5","3":"NA","4":"NA"},{"1":"France","2":"NA","3":"French","4":"fra"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Существует достаточно забавный трюк, который позволяет использовать <code>.._join()</code> вместе с <code>group_by()</code> и <code>summarise()</code>:</p>
<pre class="r"><code>homo %&gt;% 
  group_by(orientation, age &gt; 20) %&gt;% 
  summarise(my_mean = mean(s.duration.ms), n_observations = n())</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age > 20"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["my_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n_observations"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"hetero","2":"FALSE","3":"54.51500","4":"2"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>homo %&gt;% 
  group_by(orientation, age &gt; 20) %&gt;% 
  summarise(my_mean = mean(s.duration.ms), n_observations = n()) %&gt;% 
  left_join(homo)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["orientation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age > 20"],"name":[2],"type":["lgl"],"align":["right"]},{"label":["my_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n_observations"],"name":[4],"type":["int"],"align":["right"]},{"label":["speaker"],"name":[5],"type":["chr"],"align":["left"]},{"label":["s.duration.ms"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["vowel.duration.ms"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["average.f0.Hz"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["f0.range.Hz"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["perceived.as.homo"],"name":[10],"type":["int"],"align":["right"]},{"label":["perceived.as.hetero"],"name":[11],"type":["int"],"align":["right"]},{"label":["perceived.as.homo.percent"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[13],"type":["int"],"align":["right"]}],"data":[{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"A","6":"61.40","7":"112.60","8":"119.51","9":"52.5","10":"7","11":"18","12":"0.28","13":"30"},{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"B","6":"63.90","7":"126.49","8":"100.29","9":"114.0","10":"20","11":"5","12":"0.80","13":"19"},{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"G","6":"65.39","7":"147.52","8":"128.96","9":"118.2","10":"20","11":"5","12":"0.80","13":"28"},{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"H","6":"62.46","7":"120.13","8":"105.26","9":"55.7","10":"21","11":"4","12":"0.84","13":"22"},{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"L","6":"53.31","7":"112.05","8":"146.20","9":"57.8","10":"8","11":"17","12":"0.32","13":"25"},{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"M","6":"45.13","7":"133.74","8":"155.34","9":"100.5","10":"9","11":"16","12":"0.36","13":"20"},{"1":"hetero","2":"FALSE","3":"54.51500","4":"2","5":"N","6":"57.67","7":"118.02","8":"121.48","9":"37.4","10":"4","11":"21","12":"0.16","13":"29"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"A","6":"61.40","7":"112.60","8":"119.51","9":"52.5","10":"7","11":"18","12":"0.28","13":"30"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"B","6":"63.90","7":"126.49","8":"100.29","9":"114.0","10":"20","11":"5","12":"0.80","13":"19"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"G","6":"65.39","7":"147.52","8":"128.96","9":"118.2","10":"20","11":"5","12":"0.80","13":"28"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"H","6":"62.46","7":"120.13","8":"105.26","9":"55.7","10":"21","11":"4","12":"0.84","13":"22"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"L","6":"53.31","7":"112.05","8":"146.20","9":"57.8","10":"8","11":"17","12":"0.32","13":"25"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"M","6":"45.13","7":"133.74","8":"155.34","9":"100.5","10":"9","11":"16","12":"0.36","13":"20"},{"1":"hetero","2":"TRUE","3":"60.04600","4":"5","5":"N","6":"57.67","7":"118.02","8":"121.48","9":"37.4","10":"4","11":"21","12":"0.16","13":"29"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"C","6":"55.08","7":"126.81","8":"114.90","9":"103.2","10":"9","11":"16","12":"0.36","13":"29"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"D","6":"78.11","7":"119.17","8":"126.61","9":"58.8","10":"15","11":"10","12":"0.60","13":"36"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"E","6":"64.71","7":"93.68","8":"130.76","9":"37.4","10":"10","11":"15","12":"0.40","13":"27"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"F","6":"67.00","7":"127.87","8":"150.79","9":"42.0","10":"17","11":"8","12":"0.68","13":"33"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"I","6":"60.45","7":"140.44","8":"109.86","9":"96.4","10":"20","11":"5","12":"0.80","13":"22"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"J","6":"59.59","7":"121.01","8":"123.90","9":"111.7","10":"8","11":"17","12":"0.32","13":"40"},{"1":"homo","2":"TRUE","3":"63.98286","4":"7","5":"K","6":"62.94","7":"137.37","8":"119.48","9":"87.6","10":"21","11":"4","12":"0.84","13":"30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax2">

</div>
<div class="parallax">

</div>
</div>
</div>
<div id="tidyr-package" class="section level3">
<h3>5. tidyr package</h3>
<ul>
<li>Short format</li>
</ul>
<pre class="r"><code>df.short &lt;- data.frame(
                   consonant = c(&quot;stops&quot;, &quot;fricatives&quot;, &quot;affricates&quot;, &quot;nasals&quot;),
                   initial = c(123, 87, 73, 7),
                   intervocal = c(57, 77, 82, 78),
                   final = c(30, 69, 12, 104))
df.short</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["consonant"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["initial"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intervocal"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["final"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"stops","2":"123","3":"57","4":"30"},{"1":"fricatives","2":"87","3":"77","4":"69"},{"1":"affricates","2":"73","3":"82","4":"12"},{"1":"nasals","2":"7","3":"78","4":"104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Long format</li>
</ul>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["consonant"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["position"],"name":[2],"type":["chr"],"align":["left"]},{"label":["number"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"stops","2":"initial","3":"123"},{"1":"fricatives","2":"initial","3":"87"},{"1":"affricates","2":"initial","3":"73"},{"1":"nasals","2":"initial","3":"7"},{"1":"stops","2":"intervocal","3":"57"},{"1":"fricatives","2":"intervocal","3":"77"},{"1":"affricates","2":"intervocal","3":"82"},{"1":"nasals","2":"intervocal","3":"78"},{"1":"stops","2":"final","3":"30"},{"1":"fricatives","2":"final","3":"69"},{"1":"affricates","2":"final","3":"12"},{"1":"nasals","2":"final","3":"104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Short format → Long format: <code>tidyr::gather()</code></li>
</ul>
<pre class="r"><code>df.short &lt;- data.frame(
                   consonant = c(&quot;stops&quot;, &quot;fricatives&quot;, &quot;affricates&quot;, &quot;nasals&quot;),
                   initial = c(123, 87, 73, 7),
                   intervocal = c(57, 77, 82, 78),
                   final = c(30, 69, 12, 104))
df.short</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["consonant"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["initial"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intervocal"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["final"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"stops","2":"123","3":"57","4":"30"},{"1":"fricatives","2":"87","3":"77","4":"69"},{"1":"affricates","2":"73","3":"82","4":"12"},{"1":"nasals","2":"7","3":"78","4":"104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>df.short %&gt;% 
  gather(position, number, initial:final) -&gt;
  df.long
df.long</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["consonant"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["position"],"name":[2],"type":["chr"],"align":["left"]},{"label":["number"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"stops","2":"initial","3":"123"},{"1":"fricatives","2":"initial","3":"87"},{"1":"affricates","2":"initial","3":"73"},{"1":"nasals","2":"initial","3":"7"},{"1":"stops","2":"intervocal","3":"57"},{"1":"fricatives","2":"intervocal","3":"77"},{"1":"affricates","2":"intervocal","3":"82"},{"1":"nasals","2":"intervocal","3":"78"},{"1":"stops","2":"final","3":"30"},{"1":"fricatives","2":"final","3":"69"},{"1":"affricates","2":"final","3":"12"},{"1":"nasals","2":"final","3":"104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Long format → Short format: <code>tidyr::spread()</code></li>
</ul>
<pre class="r"><code>df.long %&gt;% 
  spread(position, number) -&gt;
  df.short
df.short</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["consonant"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["final"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["initial"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["intervocal"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"affricates","2":"12","3":"73","4":"82","_rn_":"1"},{"1":"fricatives","2":"69","3":"87","4":"77","_rn_":"2"},{"1":"nasals","2":"104","3":"7","4":"78","_rn_":"3"},{"1":"stops","2":"30","3":"123","4":"57","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="parallax">

</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
